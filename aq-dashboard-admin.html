<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQ Deem Savings Projects - Enhanced Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- PptxGenJS -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    
    <!-- Google Fonts - Inter for Professional Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
    
    <style>
        /* ===================================
           EXPERT DESIGN SYSTEM - REFINED
           ================================== */
        :root {
            /* Primary Brand Colors - Extended Palette */
            --aq-primary-950: #082f49;
            --aq-primary-900: #0c4a6e;
            --aq-primary-800: #075985;
            --aq-primary-700: #0369a1;
            --aq-primary-600: #0284c7;
            --aq-primary-500: #0ea5e9;
            --aq-primary-400: #38bdf8;
            --aq-primary-300: #7dd3fc;
            --aq-primary-200: #bae6fd;
            --aq-primary-100: #e0f2fe;
            --aq-primary-50: #f0f9ff;
            
            /* Semantic Colors */
            --aq-success: #10b981;
            --aq-success-light: #d1fae5;
            --aq-warning: #f59e0b;
            --aq-warning-light: #fef3c7;
            --aq-error: #ef4444;
            --aq-error-light: #fee2e2;
            
            /* Extended Gray Scale */
            --aq-gray-950: #030712;
            --aq-gray-900: #111827;
            --aq-gray-800: #1f2937;
            --aq-gray-700: #374151;
            --aq-gray-600: #4b5563;
            --aq-gray-500: #6b7280;
            --aq-gray-400: #9ca3af;
            --aq-gray-300: #d1d5db;
            --aq-gray-200: #e5e7eb;
            --aq-gray-100: #f3f4f6;
            --aq-gray-50: #f9fafb;
            --aq-gray-25: #fcfcfd;
            
            /* Multi-Layer Shadows for Depth */
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
            
            /* Refined Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Spacing Scale */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border Radius Scale */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-full: 9999px;
            
            /* Deprecated - keeping for compatibility */
            --aq-primary: #0369a1;
            --aq-primary-dark: #0c4a6e;
            --aq-primary-light: #0ea5e9;
            --aq-accent: #f59e0b;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: linear-gradient(to bottom, var(--aq-gray-50) 0%, var(--aq-gray-25) 100%);
            color: var(--aq-gray-900);
            line-height: 1.6;
            font-feature-settings: 'kern' 1, 'liga' 1;
        }
        
        /* Enhanced Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            letter-spacing: -0.025em;
        }
        
        /* ===================================
           REFINED ANIMATIONS
           ================================== */
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
            }
            to { 
                opacity: 1; 
            }
        }
        
        @keyframes slideIn {
            from { 
                transform: translateX(100%); 
                opacity: 0;
            }
            to { 
                transform: translateX(0); 
                opacity: 1;
            }
        }
        
        @keyframes scaleIn {
            from { 
                opacity: 0;
                transform: scale(0.95); 
            }
            to { 
                opacity: 1;
                transform: scale(1); 
            }
        }
        
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        
        @keyframes pulse {
            0%, 100% { 
                opacity: 1; 
            }
            50% { 
                opacity: 0.5; 
            }
        }
        
        @keyframes spin {
            from { 
                transform: rotate(0deg); 
            }
            to { 
                transform: rotate(360deg); 
            }
        }
        
        @keyframes checkmark {
            0% {
                transform: scale(0) rotate(45deg);
            }
            50% {
                transform: scale(1.2) rotate(45deg);
            }
            100% {
                transform: scale(1) rotate(45deg);
            }
        }
        
        .fade-in { 
            animation: fadeInUp 0.6s var(--transition-base); 
        }
        
        .slide-in { 
            animation: slideIn 0.4s var(--transition-base); 
        }
        
        .checkmark {
            animation: checkmark 0.5s var(--transition-base);
        }
        
        /* Staggered Animations */
        .stagger-1 { animation-delay: 0.1s; }
        .stagger-2 { animation-delay: 0.2s; }
        .stagger-3 { animation-delay: 0.3s; }
        .stagger-4 { animation-delay: 0.4s; }
        
        /* ===================================
           REFINED SCROLLBAR
           ================================== */
        ::-webkit-scrollbar { 
            width: 12px; 
            height: 12px; 
        }
        
        ::-webkit-scrollbar-track { 
            background: var(--aq-gray-100);
            border-radius: var(--radius-full);
        }
        
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, var(--aq-primary-600), var(--aq-primary-700));
            border-radius: var(--radius-full);
            border: 2px solid var(--aq-gray-100);
        }
        
        ::-webkit-scrollbar-thumb:hover { 
            background: linear-gradient(180deg, var(--aq-primary-700), var(--aq-primary-900));
        }
        
        /* ===================================
           REFINED BUTTON SYSTEM
           ================================== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            font-size: 0.875rem;
            border-radius: var(--radius-lg);
            transition: all var(--transition-base);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }
        
        /* ===================================
           CUSTOM UTILITY CLASSES
           ================================== */
        .aq-blue { 
            color: var(--aq-primary-700); 
        }
        
        .aq-bg-blue { 
            background: linear-gradient(135deg, var(--aq-primary-600), var(--aq-primary-700));
        }
        
        .aq-border-blue { 
            border-color: var(--aq-primary-600); 
        }
        
        .aq-bg-gradient {
            background: linear-gradient(135deg, var(--aq-primary-700) 0%, var(--aq-primary-900) 100%);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--aq-primary-600), var(--aq-primary-400));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* ===================================
           CHART COMPONENTS
           ================================== */
        .donut-chart-container {
            position: relative;
            height: 130px;
            width: 130px;
            margin: 0 auto;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.07));
        }
        
        /* ===================================
           PROJECT CARDS - REFINED
           ================================== */
        .project-card {
            position: relative;
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--aq-gray-200);
            transition: all var(--transition-base);
            overflow: hidden;
        }
        
        .project-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--aq-primary-600), var(--aq-primary-400));
            opacity: 0;
            transition: opacity var(--transition-base);
        }
        
        .project-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-2xl);
            border-color: var(--aq-primary-300);
        }
        
        .project-card:hover::after {
            opacity: 1;
        }
        
        /* ===================================
           LOADING & NOTIFICATIONS - REFINED
           ================================== */
        .loading-spinner {
            width: 3rem;
            height: 3rem;
            border: 4px solid var(--aq-gray-200);
            border-top-color: var(--aq-primary-600);
            border-radius: var(--radius-full);
            animation: spin 1s linear infinite;
        }
        
        .notification {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 9999;
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-2xl);
            padding: 1rem 1.5rem;
            border-left: 4px solid;
            animation: slideIn 0.3s var(--transition-base);
            max-width: 24rem;
        }
        
        .notification-success {
            border-left-color: var(--aq-success);
        }
        
        .notification-error {
            border-left-color: var(--aq-error);
        }
        
        .notification-warning {
            border-left-color: var(--aq-warning);
        }
        
        /* ===================================
           MODALS - REFINED
           ================================== */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
            animation: fadeIn 0.2s ease;
        }
        
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.3s ease;
        }
        
        /* ===================================
           ICON BUTTONS - REFINED
           ================================== */
        .icon-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2.25rem;
            height: 2.25rem;
            border-radius: var(--radius-lg);
            background: white;
            border: 1.5px solid var(--aq-gray-200);
            color: var(--aq-primary-600);
            transition: all var(--transition-fast);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .icon-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, var(--aq-primary-50), var(--aq-primary-100));
            opacity: 0;
            transition: opacity var(--transition-fast);
        }
        
        .icon-btn:hover::before {
            opacity: 1;
        }
        
        .icon-btn:hover {
            border-color: var(--aq-primary-400);
            color: var(--aq-primary-700);
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }
        
        .icon-btn svg {
            position: relative;
            z-index: 1;
        }
        
        /* ===================================
           STATUS BADGES - REFINED
           ================================== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-xs);
        }
        
        .badge-live {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .badge-upcoming {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }
        
        .badge-closed {
            background: var(--aq-gray-200);
            color: var(--aq-gray-700);
        }
        
        /* ===================================
           METRIC CARDS - REFINED
           ================================== */
        .metric-card {
            position: relative;
            overflow: hidden;
            border: 1px solid var(--aq-gray-200);
            border-radius: var(--radius-xl);
            background: white;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-base);
        }
        
        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--card-accent, var(--aq-primary-600));
            opacity: 0;
            transition: opacity var(--transition-base);
        }
        
        .metric-card:hover {
            box-shadow: var(--shadow-xl);
            border-color: var(--aq-primary-200);
            transform: translateY(-2px);
        }
        
        .metric-card:hover::before {
            opacity: 1;
        }
        
        .metric-icon-wrapper {
            background: linear-gradient(135deg, var(--icon-bg-start, var(--aq-primary-50)), var(--icon-bg-end, var(--aq-primary-100)));
            border-radius: var(--radius-xl);
            padding: 0.875rem;
            box-shadow: var(--shadow-inner);
        }
        
        /* ===================================
           HEADER - REFINED
           ================================== */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--aq-gray-200);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 50;
        }
        
        .header-accent {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--aq-primary-600), var(--aq-primary-400), var(--aq-primary-600));
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
        }
        
        .logo-wrapper {
            background: linear-gradient(135deg, var(--aq-primary-50), var(--aq-primary-100));
            border-radius: var(--radius-xl);
            padding: 0.75rem;
            box-shadow: var(--shadow-inner);
        }
        
        /* ===================================
           SECTION HEADERS - REFINED
           ================================== */
        .section-header {
            background: linear-gradient(135deg, var(--aq-primary-700), var(--aq-primary-900));
            border-radius: var(--radius-2xl);
            padding: 2.5rem;
            color: white;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }
        
        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            background: linear-gradient(135deg, transparent, rgba(255,255,255,0.1));
            border-radius: var(--radius-2xl);
        }
        
        .section-header-content {
            position: relative;
            z-index: 1;
        }
        
        /* ===================================
           FILTER TABS - REFINED
           ================================== */
        .filter-tabs {
            display: flex;
            gap: 0.75rem;
            padding: 0.5rem;
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--aq-gray-200);
        }
        
        .filter-tab {
            flex: 1;
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 600;
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast);
            cursor: pointer;
            border: none;
            background: transparent;
            color: var(--aq-gray-600);
            white-space: nowrap;
        }
        
        .filter-tab:hover {
            background: var(--aq-gray-50);
            color: var(--aq-gray-900);
        }
        
        .filter-tab.active {
            background: linear-gradient(135deg, var(--aq-primary-600), var(--aq-primary-700));
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        /* Daily Rate Styling */
        .daily-rate-card {
            transition: all 0.2s ease;
        }
        
        .daily-rate-card:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* ===================================
           RESPONSIVE DESIGN
           ================================== */
        @media (max-width: 1024px) {
            .donut-chart-container {
                height: 110px;
                width: 110px;
            }
        }
        
        @media (max-width: 768px) {
            .donut-chart-container {
                height: 100px;
                width: 100px;
            }
            
            header h1 {
                font-size: 1.5rem;
            }
            
            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }
            
            .filter-tabs {
                flex-direction: column;
            }
            
            .filter-tab {
                width: 100%;
            }
        }
        
        @media (max-width: 640px) {
            .section-header {
                padding: 1.5rem;
            }
            
            h1 { font-size: 1.75rem; }
            h2 { font-size: 1.5rem; }
        }
        
        /* ===================================
           PRINT OPTIMIZATION
           ================================== */
        @media print {
            .no-print {
                display: none !important;
            }
            
            body {
                background: white;
            }
            
            .project-card {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid var(--aq-gray-300);
            }
            
            .header {
                position: static;
            }
        }
        
        /* ===================================
           ACCESSIBILITY
           ================================== */
        .focus-visible:focus {
            outline: 2px solid var(--aq-primary-600);
            outline-offset: 2px;
            border-radius: var(--radius-sm);
        }
        
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Hidden print elements */
        .hidden-print {
            position: absolute;
            left: -9999px;
            top: -9999px;
            visibility: hidden;
        }
        
        /* ===================================
           TABLE STYLING - REFINED
           ================================== */
        .history-table {
            overflow-x: auto;
        }
        
        .history-table table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        
        .history-table th,
        .history-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--aq-gray-200);
        }
        
        .history-table th {
            background: linear-gradient(to bottom, var(--aq-gray-50), var(--aq-gray-100));
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--aq-gray-700);
            border-bottom: 2px solid var(--aq-gray-300);
        }
        
        .history-table tbody tr {
            transition: background-color var(--transition-fast);
        }
        
        .history-table tr:hover {
            background: linear-gradient(to right, var(--aq-primary-50), transparent);
        }
        
        .history-table tbody tr:last-child td {
            border-bottom: none;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.top-0{top:0px}.z-10{z-index:10}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:0.25rem}.mt-6{margin-top:1.5rem}.mb-3{margin-bottom:0.75rem}.mt-4{margin-top:1rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-12{height:3rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-8{height:2rem}.max-h-\[90vh\]{max-height:90vh}.min-h-screen{min-height:100vh}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-8{width:2rem}.w-auto{width:auto}.w-full{width:100%}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.max-w-6xl{max-width:72rem}.max-w-7xl{max-width:80rem}.flex-1{flex:1 1 0%}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.overflow-y-auto{overflow-y:auto}.rounded-2xl{border-radius:1rem}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-l-2{border-left-width:2px}.border-t{border-top-width:1px}.border-t-2{border-top-width:2px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-sky-200{--tw-border-opacity:1;border-color:rgb(186 230 253 / var(--tw-border-opacity, 1))}.border-amber-200{--tw-border-opacity:1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-cyan-50{--tw-bg-opacity:1;background-color:rgb(236 254 255 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-purple-50{--tw-bg-opacity:1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-sky-600{--tw-bg-opacity:1;background-color:rgb(2 132 199 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity:1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right, var(--tw-gradient-stops))}.from-gray-50{--tw-gradient-from:#f9fafb var(--tw-gradient-from-position);--tw-gradient-to:rgb(249 250 251 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-sky-50{--tw-gradient-from:#f0f9ff var(--tw-gradient-from-position);--tw-gradient-to:rgb(240 249 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-blue-50{--tw-gradient-to:#eff6ff var(--tw-gradient-to-position)}.to-white{--tw-gradient-to:#fff var(--tw-gradient-to-position)}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.pl-4{padding-left:1rem}.pt-6{padding-top:1.5rem}.pb-2{padding-bottom:0.5rem}.pt-4{padding-top:1rem}.text-left{text-align:left}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.tracking-wider{letter-spacing:0.05em}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-cyan-900{--tw-text-opacity:1;color:rgb(22 78 99 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-orange-700{--tw-text-opacity:1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity:1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-purple-900{--tw-text-opacity:1;color:rgb(88 28 135 / var(--tw-text-opacity, 1))}.text-sky-100{--tw-text-opacity:1;color:rgb(224 242 254 / var(--tw-text-opacity, 1))}.text-sky-700{--tw-text-opacity:1;color:rgb(3 105 161 / var(--tw-text-opacity, 1))}.text-sky-900{--tw-text-opacity:1;color:rgb(12 74 110 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-cyan-600{--tw-text-opacity:1;color:rgb(8 145 178 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity:1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-sky-700:hover{--tw-bg-opacity:1;background-color:rgb(3 105 161 / var(--tw-bg-opacity, 1))}.hover\:bg-sky-800:hover{--tw-bg-opacity:1;background-color:rgb(7 89 133 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\:text-gray-700:hover{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.hover\:text-gray-900:hover{--tw-text-opacity:1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}.focus\:ring-cyan-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(6 182 212 / var(--tw-ring-opacity, 1))}.focus\:ring-purple-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(168 85 247 / var(--tw-ring-opacity, 1))}.focus\:ring-sky-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(14 165 233 / var(--tw-ring-opacity, 1))}@media (min-width: 640px){.sm\:inline{display:inline}.sm\:px-6{padding-left:1.5rem;padding-right:1.5rem}}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.lg\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.lg\:px-8{padding-left:2rem;padding-right:2rem}}@media (min-width: 1280px){.xl\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}</style></head>
<body class="bg-gray-50">
    
    <!-- Professional Header -->
    <header class="header">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div class="flex items-center gap-6">
                    <div class="flex items-center gap-4">
                        <div class="logo-wrapper">
                            <img src="arabian-qudra-logo.jpg" alt="Arabian Qudra" class="h-12 w-auto" onerror="this.style.display='none'" style="display: none;">
                        </div>
                        <div class="border-l-2 border-gray-300 pl-4">
                            <h1 class="text-2xl font-bold gradient-text">AQ Deem Savings Projects</h1>
                            <p class="text-sm text-gray-600 font-medium">Infrastructure Project Management Dashboard</p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-3 flex-wrap no-print">
                    <button onclick="saveViewOnlyVersion()" class="btn" style="background: white; color: var(--aq-gray-700); border: 1.5px solid var(--aq-gray-300);">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                        </svg>
                        <span class="hidden sm:inline">View-Only</span>
                    </button>
                    <button onclick="showShareModal()" class="btn" style="background: linear-gradient(135deg, #10b981, #059669); color: white;">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                        </svg>
                        <span class="hidden sm:inline">Share</span>
                    </button>
                    <button onclick="exportToPowerPoint()" class="btn aq-bg-blue text-white">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                        </svg>
                        <span class="hidden sm:inline">Export</span>
                    </button>
                    <button onclick="clearLocalStorage()" class="btn" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white;" title="Clear all saved data">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        <span class="hidden sm:inline">Clear</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="header-accent"></div>
    </header>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Portfolio Overview -->
        <div class="mb-8 fade-in">
            <div class="section-header">
                <div class="section-header-content">
                    <h2 class="text-3xl font-bold mb-2">Portfolio Overview</h2>
                    <p class="text-sky-100 font-medium">Real-time project tracking with daily installation monitoring</p>
                </div>
            </div>
        </div>

        <!-- Metrics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="metric-card fade-in stagger-1" style="--card-accent: var(--aq-primary-600); --icon-bg-start: var(--aq-primary-50); --icon-bg-end: var(--aq-primary-100);">
                <div class="p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <p class="text-xs text-gray-600 mb-1 font-bold uppercase tracking-wider">Total Projects</p>
                            <p class="text-4xl font-bold text-gray-900 mb-2" id="totalProjects">9</p>
                            <p class="text-xs text-gray-500 font-medium" id="projectCount">6 Live • 3 Upcoming • 0 Closed</p>
                        </div>
                        <div class="metric-icon-wrapper">
                            <svg class="w-8 h-8 text-sky-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="metric-card fade-in stagger-2" style="--card-accent: #10b981; --icon-bg-start: #d1fae5; --icon-bg-end: #a7f3d0;">
                <div class="p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <p class="text-xs text-gray-600 mb-1 font-bold uppercase tracking-wider">Avg Installation</p>
                            <p class="text-4xl font-bold text-gray-900 mb-2" id="avgProgress">0.0%</p>
                            <p class="text-xs text-gray-500 font-medium">Across live projects</p>
                        </div>
                        <div class="metric-icon-wrapper" style="--icon-bg-start: #d1fae5; --icon-bg-end: #a7f3d0;">
                            <svg class="w-8 h-8 text-green-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="metric-card fade-in stagger-3" style="--card-accent: #8b5cf6; --icon-bg-start: #ede9fe; --icon-bg-end: #ddd6fe;">
                <div class="p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <p class="text-xs text-gray-600 mb-1 font-bold uppercase tracking-wider">Total Components</p>
                            <p class="text-4xl font-bold text-gray-900 mb-2" id="totalComponents">0</p>
                            <p class="text-xs text-gray-500 font-medium">Lights, A/C, Sensors</p>
                        </div>
                        <div class="metric-icon-wrapper" style="--icon-bg-start: #ede9fe; --icon-bg-end: #ddd6fe;">
                            <svg class="w-8 h-8 text-purple-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="metric-card fade-in stagger-4" style="--card-accent: #f59e0b; --icon-bg-start: #fef3c7; --icon-bg-end: #fde68a;">
                <div class="p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <p class="text-xs text-gray-600 mb-1 font-bold uppercase tracking-wider">Last Updated</p>
                            <p class="text-4xl font-bold text-gray-900 mb-2">Today</p>
                            <p class="text-xs text-gray-500 font-medium" id="currentDate">12/11/2025</p>
                        </div>
                        <div class="metric-icon-wrapper" style="--icon-bg-start: #fef3c7; --icon-bg-end: #fde68a;">
                            <svg class="w-8 h-8 text-orange-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="mb-8 no-print fade-in">
            <div class="filter-tabs">
                <button onclick="filterProjects('all')" id="filterAll" class="filter-tab active">All Projects (9)</button>
                <button onclick="filterProjects('live')" id="filterLive" class="filter-tab">Live Projects (6)</button>
                <button onclick="filterProjects('upcoming')" id="filterUpcoming" class="filter-tab">Upcoming (3)</button>
                <button onclick="filterProjects('closed')" id="filterClosed" class="filter-tab">Closed (0)</button>
            </div>
        </div>

        <!-- Projects Grid -->
        <div id="projectsGrid" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-R</h3>
                                <p class="text-sm text-gray-600">Riyadh</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-live">LIVE</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-R" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-R" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-R" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        
                        <div class="mt-4 pt-4 border-t-2 border-gray-200">
                            <div class="flex items-center justify-between mb-3">
                                <p class="text-sm font-bold text-gray-700">📈 Last 3 Days</p>
                                <button onclick="showHistoryModal('MOI-R')" class="icon-btn" title="View Full History">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="bg-gradient-to-br from-gray-50 to-white rounded-lg p-3 border border-gray-200 shadow-sm">
                                <table class="w-full text-xs">
                                    <thead>
                                        <tr class="border-b border-gray-200">
                                            <th class="text-left pb-2 font-semibold text-gray-600">Date</th>
                                            <th class="text-center pb-2 font-semibold text-gray-600">💡</th>
                                            <th class="text-center pb-2 font-semibold text-gray-600">❄️</th>
                                            <th class="text-center pb-2 font-semibold text-gray-600">📡</th>
                                            <th class="text-center pb-2 font-semibold text-gray-600">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                                <td class="py-2 font-medium text-gray-700">Dec 10</td>
                                                <td class="text-center py-2 font-bold text-blue-600">155</td>
                                                <td class="text-center py-2 font-bold text-cyan-600">454</td>
                                                <td class="text-center py-2 font-bold text-purple-600">222</td>
                                                <td class="text-center py-2 font-bold text-gray-900">831</td>
                                            </tr>
                                            
                                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                                <td class="py-2 font-medium text-gray-700">Dec 9</td>
                                                <td class="text-center py-2 font-bold text-blue-600">4545</td>
                                                <td class="text-center py-2 font-bold text-cyan-600">545</td>
                                                <td class="text-center py-2 font-bold text-purple-600">54</td>
                                                <td class="text-center py-2 font-bold text-gray-900">5144</td>
                                            </tr>
                                            
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-R')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOH-R</h3>
                                <p class="text-sm text-gray-600">Riyadh</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-live">LIVE</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOH-R" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOH-R" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOH-R" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOH-R')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-K</h3>
                                <p class="text-sm text-gray-600">Makkah</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-live">LIVE</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-K" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-K" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-K" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-K')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-K1</h3>
                                <p class="text-sm text-gray-600">Makkah 1</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-live">LIVE</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-K1" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-K1" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-K1" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-K1')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-E1</h3>
                                <p class="text-sm text-gray-600">Eastern 1</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-live">LIVE</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-E1" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-E1" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-E1" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-E1')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-E2</h3>
                                <p class="text-sm text-gray-600">Eastern 2</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-live">LIVE</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-E2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-E2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-E2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-E2')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-K2</h3>
                                <p class="text-sm text-gray-600">Makkah 2</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-upcoming">UPCOMING</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-K2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-K2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-K2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-K2')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-K3</h3>
                                <p class="text-sm text-gray-600">Makkah 3</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-upcoming">UPCOMING</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-K3" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-K3" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-K3" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-K3')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                
                    <div class="bg-white rounded-xl shadow-lg p-6 project-card">
                        <div class="flex justify-between mb-4">
                            <div>
                                <h3 class="text-xl font-bold">MOI-M2</h3>
                                <p class="text-sm text-gray-600">Madinah 2</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-bold badge badge-upcoming">UPCOMING</span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-sm font-semibold text-center mb-3">Installation Progress</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutLights-MOI-M2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">💡</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutAc-MOI-M2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">❄️</p>
                                </div>
                                <div class="text-center">
                                    <div class="donut-chart-container mb-2">
                                        <canvas id="donutSensors-MOI-M2" width="150" height="150" style="display: block; box-sizing: border-box; height: 100px; width: 100px;"></canvas>
                                    </div>
                                    <p class="text-xs font-semibold">📡</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3">
                            <p class="text-xs font-bold text-center mb-2">📦 Material Availability</p>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-blue-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-cyan-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                                <div class="bg-white rounded p-2 text-center">
                                    <div class="text-sm font-bold text-purple-600">0%</div>
                                    <div class="text-xs text-gray-500">0/0</div>
                                </div>
                            </div>
                        </div>

                        

                        <div class="mt-4 pt-4 border-t no-print">
                            <button onclick="editProject('MOI-M2')" class="w-full px-4 py-2 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                                ✏️ Edit Project
                            </button>
                        </div>
                    </div>
                </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="editModal" class="modal">
        <div class="modal-overlay fixed inset-0 bg-black bg-opacity-50" onclick="closeModal()"></div>
        <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b-2 aq-border-blue p-6 z-10">
                    <div class="flex items-center justify-between">
                        <h2 class="text-2xl font-bold aq-blue" id="modalTitle">Edit Project</h2>
                        <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="p-6">
                    <!-- Tabs -->
                    <div class="flex gap-2 mb-6 border-b">
                        <button onclick="switchEditTab('details')" id="tabDetails" class="px-4 py-2 font-semibold aq-blue border-b-2 aq-border-blue">
                            Project Details
                        </button>
                        <button onclick="switchEditTab('daily')" id="tabDaily" class="px-4 py-2 font-semibold text-gray-600 hover:text-gray-900">
                            Daily Installation
                        </button>
                    </div>

                    <!-- Details Tab -->
                    <div id="detailsTab" class="space-y-6">
                        <!-- Project Info -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Project Name</label>
                                <input type="text" id="editProjectName" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-500" readonly="">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Status</label>
                                <select id="editStatus" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-500">
                                    <option value="live">Live</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="closed">Closed</option>
                                </select>
                            </div>
                        </div>

                        <!-- Lights Section -->
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-blue-900 mb-4">💡 Lighting</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Total Quantity</label>
                                    <input type="number" id="editLightsQty" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Available</label>
                                    <input type="number" id="editLightsAvail" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Installed</label>
                                    <input type="number" id="editLightsInst" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Completion Date</label>
                                    <input type="date" id="editLightsDate" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- AC Section -->
                        <div class="bg-cyan-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-cyan-900 mb-4">❄️ Air Conditioning</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Total Quantity</label>
                                    <input type="number" id="editAcQty" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Available</label>
                                    <input type="number" id="editAcAvail" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Installed</label>
                                    <input type="number" id="editAcInst" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Completion Date</label>
                                    <input type="date" id="editAcDate" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500">
                                </div>
                            </div>
                        </div>

                        <!-- Sensors Section -->
                        <div class="bg-purple-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-purple-900 mb-4">📡 Sensors</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Total Quantity</label>
                                    <input type="number" id="editSensorsQty" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Available</label>
                                    <input type="number" id="editSensorsAvail" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Installed</label>
                                    <input type="number" id="editSensorsInst" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Completion Date</label>
                                    <input type="date" id="editSensorsDate" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Daily Installation Tab -->
                    <div id="dailyTab" class="space-y-6 hidden">
                        <!-- Add New Entry -->
                        <div class="bg-gradient-to-r from-sky-50 to-blue-50 rounded-xl p-6 border-2 border-sky-200">
                            <h3 class="text-lg font-bold text-sky-900 mb-4">📅 Add Daily Installation Entry</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Date</label>
                                    <input type="date" id="dailyDate" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-500">
                                </div>
                                <div></div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">💡 Lights Installed</label>
                                    <input type="number" id="dailyLights" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="0">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">❄️ AC Installed</label>
                                    <input type="number" id="dailyAc" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="0">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">📡 Sensors Installed</label>
                                    <input type="number" id="dailySensors" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="0">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Notes (Optional)</label>
                                    <input type="text" id="dailyNotes" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-500" placeholder="Any notes...">
                                </div>
                            </div>
                            <button onclick="addDailyEntry()" class="w-full px-6 py-3 bg-sky-600 text-white rounded-lg font-semibold hover:bg-sky-700 transition-colors">
                                ➕ Add Entry
                            </button>
                        </div>

                        <!-- Daily History -->
                        <div class="bg-white rounded-xl border-2 border-gray-200 p-6">
                            <h3 class="text-lg font-bold text-gray-900 mb-4">📊 Installation History</h3>
                            <div id="dailyHistoryList" class="space-y-2">
                                <!-- History entries will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-4 mt-6 pt-6 border-t">
                        <button onclick="saveProject()" class="flex-1 px-6 py-3 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800 transition-colors">
                            💾 Save Changes
                        </button>
                        <button onclick="closeModal()" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Daily Installation History Modal -->
    <div id="historyModal" class="modal">
        <div class="modal-overlay fixed inset-0 bg-black bg-opacity-50" onclick="closeHistoryModal()"></div>
        <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b-2 aq-border-blue p-6 z-10">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="text-2xl font-bold aq-blue" id="historyModalTitle">Daily Installation History</h2>
                            <p class="text-sm text-gray-600 mt-1" id="historyModalSubtitle"></p>
                        </div>
                        <button onclick="closeHistoryModal()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="p-6">
                    <!-- Chart -->
                    <div class="bg-gradient-to-br from-gray-50 to-white rounded-xl p-6 mb-6 shadow-inner">
                        <canvas id="historyChart" height="100"></canvas>
                    </div>

                    <!-- Table -->
                    <div class="history-table bg-white rounded-xl border">
                        <table id="historyTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>💡 Lights</th>
                                    <th>❄️ AC</th>
                                    <th>📡 Sensors</th>
                                    <th>Total</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <!-- Populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Link Modal -->
    <div id="shareModal" class="hidden fixed inset-0 z-50">
        <div class="modal-overlay fixed inset-0 bg-black bg-opacity-50" onclick="closeShareModal()"></div>
        <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8">
                <h2 class="text-2xl font-bold aq-blue mb-4">🔗 Share Dashboard</h2>
                <p class="text-gray-600 mb-6">Share this link to allow others to view your dashboard with current data</p>
                <div class="flex gap-3 mb-6">
                    <input type="text" id="shareLink" class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500" readonly="">
                    <button onclick="copyShareLink()" class="px-6 py-3 aq-bg-blue text-white rounded-lg font-semibold hover:bg-sky-800">
                        📋 Copy
                    </button>
                </div>
                <div class="flex gap-3">
                    <button onclick="generateNewShareLink()" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                        🔄 Refresh Link
                    </button>
                    <button onclick="closeShareModal()" class="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl p-8 text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-lg font-semibold text-gray-900" id="loadingText">Processing...</p>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <script>
        'use strict';

        // Application State with Daily Installation Tracking
        const AppState = {/**
 * ===============================================
 * GOOGLE SHEETS INTEGRATION FOR AQ DASHBOARD
 * ===============================================
 * 
 * ADD THIS CODE TO YOUR EXISTING DASHBOARD
 * 
 * Instructions:
 * 1. Open your AQ-Dashboard-Design-Refined.html
 * 2. Find the line: const AppState = {
 * 3. PASTE THIS ENTIRE FILE right ABOVE that line
 * 4. Change GOOGLE_SHEETS_API_URL to your Web App URL
 * 5. Change ADMIN_PASSWORD to match your Apps Script password
 * 6. Save the file
 * 
 * ===============================================
 */

// ⚠️ CONFIGURATION - CHANGE THESE VALUES ⚠️
const GOOGLE_SHEETS_API_URL = 'https://script.google.com/macros/s/AKfycbzfKUWGvR_fgWOkOdLAR8omJLWWQ6l386gIJmYoA7p0k6WtWH7dHPreL9_a9NM20EqV/exec'; // From Apps Script deployment
const ADMIN_PASSWORD = 'Abcd.1234'; // Must match Apps Script password

// Google Sheets API Handler
const GoogleSheetsAPI = {
    // Cached password (stored in session)
    cachedPassword: null,
    
    // Load data from Google Sheets
    async loadData() {
        try {
            showNotification('📥 Loading data from Google Sheets...', 'info');
            
            const response = await fetch(GOOGLE_SHEETS_API_URL, {
                method: 'GET',
                headers: {
                    'Accept': 'application/json'
                }
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            // Handle empty response
            if (!data || data.length === 0) {
                showNotification('ℹ️ No data in Google Sheets yet. Add your first project!', 'warning');
                return false;
            }
            
            // Update AppState
            AppState.projects = data;
            
            // Ensure all projects have dailyInstallation array
            AppState.projects.forEach(project => {
                if (!project.dailyInstallation) {
                    project.dailyInstallation = [];
                }
            });
            
            // Save to localStorage as cache
            saveToLocalStorage();
            
            // Update UI
            renderProjects();
            updateMetrics();
            
            showNotification('✅ Data loaded successfully from Google Sheets', 'success');
            console.log('Loaded projects from Google Sheets:', AppState.projects);
            
            return true;
            
        } catch (error) {
            console.error('Error loading from Google Sheets:', error);
            showNotification('⚠️ Failed to load from Google Sheets: ' + error.message, 'error');
            
            // Try loading from localStorage as fallback
            const hasLocalData = loadFromLocalStorage();
            if (hasLocalData) {
                showNotification('📂 Loaded cached data from browser storage', 'warning');
                renderProjects();
                updateMetrics();
            }
            
            return false;
        }
    },
    
    // Save data to Google Sheets
    async saveData(projects) {
        try {
            // Get password if not cached
            if (!this.cachedPassword) {
                this.cachedPassword = prompt('🔐 Enter admin password to save data:');
                if (!this.cachedPassword) {
                    showNotification('❌ Password required to save data', 'error');
                    return false;
                }
            }
            
            showNotification('💾 Saving data to Google Sheets...', 'info');
            
            const response = await fetch(GOOGLE_SHEETS_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    password: this.cachedPassword,
                    projects: projects
                })
            });
            
            const result = await response.json();
            
            // Check for error in response
            if (result.error || result.statusCode !== undefined && result.statusCode !== 200) {
                const errorMsg = result.error || result.data?.error || 'Unknown error';
                
                // If unauthorized, clear cached password
                if (errorMsg.includes('Unauthorized') || errorMsg.includes('Invalid password')) {
                    this.cachedPassword = null;
                    showNotification('❌ Invalid password. Please try again.', 'error');
                    return this.saveData(projects); // Retry with new password prompt
                }
                
                throw new Error(errorMsg);
            }
            
            // Success
            console.log('Data saved to Google Sheets:', result);
            showNotification('✅ Data saved successfully to Google Sheets!', 'success');
            
            // Update localStorage cache
            saveToLocalStorage();
            
            return true;
            
        } catch (error) {
            console.error('Error saving to Google Sheets:', error);
            showNotification('⚠️ Failed to save to Google Sheets: ' + error.message, 'error');
            
            // Still save to localStorage as backup
            saveToLocalStorage();
            showNotification('💾 Data saved to local browser storage as backup', 'warning');
            
            return false;
        }
    },
    
    // Clear cached password
    clearPassword() {
        this.cachedPassword = null;
        showNotification('🔓 Password cleared. You\'ll be prompted again.', 'info');
    },
    
    // Test connection
    async testConnection() {
        try {
            const response = await fetch(GOOGLE_SHEETS_API_URL, {
                method: 'GET'
            });
            
            if (response.ok) {
                showNotification('✅ Connected to Google Sheets successfully!', 'success');
                return true;
            } else {
                throw new Error(`HTTP ${response.status}`);
            }
        } catch (error) {
            showNotification('❌ Cannot connect to Google Sheets: ' + error.message, 'error');
            return false;
        }
    }
};

// Add "info" type to notification system (if not already exists)
const originalShowNotification = window.showNotification;
window.showNotification = function(message, type = 'success') {
    const notification = document.getElementById('notification');
    if (!notification) return;
    
    notification.textContent = message;
    notification.className = 'notification';
    
    if (type === 'success') {
        notification.classList.add('success');
    } else if (type === 'error') {
        notification.classList.add('error');
    } else if (type === 'warning') {
        notification.classList.add('warning');
    } else if (type === 'info') {
        notification.classList.add('info');
    }
    
    notification.classList.remove('hidden');
    
    setTimeout(() => {
        notification.classList.add('hidden');
    }, type === 'error' ? 5000 : 3000);
};

// Override saveProject to also save to Google Sheets
const originalSaveProject = window.saveProject;
window.saveProject = async function() {
    // Call original save (updates AppState and localStorage)
    originalSaveProject();
    
    // Also save to Google Sheets
    await GoogleSheetsAPI.saveData(AppState.projects);
};

// Override addDailyEntry to also save to Google Sheets
const originalAddDailyEntry = window.addDailyEntry;
window.addDailyEntry = async function() {
    // Call original add (updates AppState and localStorage)
    originalAddDailyEntry();
    
    // Also save to Google Sheets
    await GoogleSheetsAPI.saveData(AppState.projects);
};

// Override deleteDailyEntry to also save to Google Sheets
const originalDeleteDailyEntry = window.deleteDailyEntry;
window.deleteDailyEntry = async function(projectId, index) {
    // Call original delete (updates AppState and localStorage)
    originalDeleteDailyEntry(projectId, index);
    
    // Also save to Google Sheets
    await GoogleSheetsAPI.saveData(AppState.projects);
};

// Load data on startup
document.addEventListener('DOMContentLoaded', async () => {
    console.log('🚀 AQ Dashboard with Google Sheets Integration');
    console.log('📡 API URL:', GOOGLE_SHEETS_API_URL);
    
    // Check if API URL is configured
    if (GOOGLE_SHEETS_API_URL === 'YOUR_WEB_APP_URL_HERE') {
        showNotification('⚠️ Google Sheets API URL not configured! Using local storage only.', 'error');
        loadFromLocalStorage();
        renderProjects();
        updateMetrics();
        return;
    }
    
    // Try to load from Google Sheets first
    const loaded = await GoogleSheetsAPI.loadData();
    
    // If failed, try localStorage
    if (!loaded) {
        const hasLocalData = loadFromLocalStorage();
        if (hasLocalData) {
            renderProjects();
            updateMetrics();
        }
    }
    
    // Setup event listeners
    setupEventListeners();
});

// Add refresh button to header
function addRefreshButton() {
    const header = document.querySelector('header');
    if (!header) return;
    
    const refreshBtn = document.createElement('button');
    refreshBtn.className = 'btn-secondary';
    refreshBtn.innerHTML = `
        <svg class="w-4 h-4 mr-2 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
        </svg>
        Refresh Data
    `;
    refreshBtn.onclick = async () => {
        await GoogleSheetsAPI.loadData();
    };
    
    const btnContainer = header.querySelector('.flex.items-center.space-x-2');
    if (btnContainer) {
        btnContainer.insertBefore(refreshBtn, btnContainer.firstChild);
    }
}

// Add sync status indicator
function addSyncStatus() {
    const header = document.querySelector('header');
    if (!header) return;
    
    const statusDiv = document.createElement('div');
    statusDiv.id = 'syncStatus';
    statusDiv.className = 'text-sm text-gray-300 ml-4';
    statusDiv.innerHTML = `
        <span class="inline-flex items-center">
            <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
            Synced with Google Sheets
        </span>
    `;
    
    const btnContainer = header.querySelector('.flex.items-center.space-x-2');
    if (btnContainer) {
        btnContainer.appendChild(statusDiv);
    }
}

// Add these UI enhancements when DOM is ready
setTimeout(() => {
    addRefreshButton();
    addSyncStatus();
}, 1000);

console.log('✅ Google Sheets integration loaded');
            projects: [
                {
                    id: 'MOI-R', name: 'MOI-R', status: 'live', type: 'Riyadh', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOH-R', name: 'MOH-R', status: 'live', type: 'Riyadh', client: 'MOH', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-K', name: 'MOI-K', status: 'live', type: 'Makkah', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-K1', name: 'MOI-K1', status: 'live', type: 'Makkah 1', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-E1', name: 'MOI-E1', status: 'live', type: 'Eastern 1', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-E2', name: 'MOI-E2', status: 'live', type: 'Eastern 2', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-K2', name: 'MOI-K2', status: 'upcoming', type: 'Makkah 2', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-K3', name: 'MOI-K3', status: 'upcoming', type: 'Makkah 3', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                },
                {
                    id: 'MOI-M2', name: 'MOI-M2', status: 'upcoming', type: 'Madinah 2', client: 'MOI', 
                    startDate: '', currentDate: new Date().toISOString().split('T')[0],
                    lights: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    ac: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    sensors: {totalQuantity: 0, totalAvailable: 0, totalInstalled: 0, contractualCompletionDate: ''},
                    dailyInstallation: []
                }
            ],
            currentFilter: 'all',
            editingProjectId: null,
            projectDonutCharts: {},
            historyChart: null,
            isLoading: false
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Priority: Shared data > localStorage > Default empty data
                const hasSharedData = loadSharedData();
                if (!hasSharedData) {
                    loadFromLocalStorage(); // Try loading from localStorage if no shared data
                }
                
                renderProjects();
                setupEventListeners();
                updateMetrics();
                // Set today's date in daily entry field
                document.getElementById('dailyDate').value = new Date().toISOString().split('T')[0];
            } catch (error) {
                console.error('Initialization error:', error);
                showNotification('⚠️ Error loading dashboard', 'error');
            }
        });

        // Event Listeners
        function setupEventListeners() {
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeModal();
                    closeShareModal();
                    closeHistoryModal();
                }
            });
        }

        // Data Loading
        function loadSharedData() {
            try {
                const params = new URLSearchParams(window.location.search);
                const sharedData = params.get('data');
                if (sharedData) {
                    AppState.projects = JSON.parse(atob(sharedData));
                    // Ensure dailyInstallation array exists for backward compatibility
                    AppState.projects.forEach(p => {
                        if (!p.dailyInstallation) p.dailyInstallation = [];
                    });
                    showNotification('✓ Loaded shared dashboard data!');
                    return true;
                }
            } catch (error) {
                console.error('Failed to load shared data:', error);
                showNotification('⚠️ Could not load shared data', 'error');
            }
            return false;
        }

        // Share Functions
        function generateShareLink() {
            try {
                const encodedData = btoa(JSON.stringify(AppState.projects));
                return `${window.location.origin}${window.location.pathname}?data=${encodedData}`;
            } catch (error) {
                console.error('Failed to generate share link:', error);
                return '';
            }
        }

        function showShareModal() {
            // Check if there's any actual data entered
            const hasData = AppState.projects.some(p => 
                p.lights.totalQuantity > 0 || 
                p.ac.totalQuantity > 0 || 
                p.sensors.totalQuantity > 0 ||
                (p.dailyInstallation && p.dailyInstallation.length > 0)
            );
            
            if (!hasData) {
                showNotification('ℹ️ Note: You haven\'t entered any project data yet. The share link will contain empty projects.', 'warning');
            }
            
            const link = generateShareLink();
            document.getElementById('shareLink').value = link;
            document.getElementById('shareModal').classList.remove('hidden');
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.add('hidden');
        }

        function copyShareLink() {
            const linkInput = document.getElementById('shareLink');
            try {
                linkInput.select();
                linkInput.setSelectionRange(0, 99999);
                document.execCommand('copy');
                showNotification('✓ Link copied to clipboard!');
            } catch (error) {
                console.error('Failed to copy:', error);
                showNotification('⚠️ Could not copy link', 'error');
            }
        }

        function generateNewShareLink() {
            const link = generateShareLink();
            document.getElementById('shareLink').value = link;
            showNotification('✓ Link refreshed with la…</script>


</body></html>